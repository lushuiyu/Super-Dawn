class QuickOrderListRemoveButton extends HTMLElement{constructor(){super(),this.addEventListener("click",t=>{t.preventDefault(),this.closest("quick-order-list").updateQuantity(this.dataset.index,0)})}}customElements.define("quick-order-list-remove-button",QuickOrderListRemoveButton);class QuickOrderListRemoveAllButton extends HTMLElement{constructor(){super();var t=Array.from(document.querySelectorAll("[data-variant-id]"));const e={};let i=!1;this.quickOrderList=this.closest("quick-order-list"),t.forEach(t=>{0<parseInt(t.dataset.cartQty)&&(i=!0,e[parseInt(t.dataset.variantId)]=0)}),i||this.classList.add("hidden"),this.actions={confirm:"confirm",remove:"remove",cancel:"cancel"},this.addEventListener("click",t=>{t.preventDefault(),this.dataset.action===this.actions.confirm?this.toggleConfirmation(!1,!0):this.dataset.action===this.actions.remove?(this.quickOrderList.updateMultipleQty(e),this.toggleConfirmation(!0,!1)):this.dataset.action===this.actions.cancel&&this.toggleConfirmation(!0,!1)})}toggleConfirmation(t,e){this.quickOrderList.querySelector(".quick-order-list-total__confirmation").classList.toggle("hidden",t),this.quickOrderList.querySelector(".quick-order-list-total__info").classList.toggle("hidden",e)}}customElements.define("quick-order-list-remove-all-button",QuickOrderListRemoveAllButton);class QuickOrderList extends HTMLElement{constructor(){super(),this.cart=document.querySelector("cart-drawer"),this.actions={add:"ADD",update:"UPDATE"},this.quickOrderListId="quick-order-list",this.variantItemStatusElement=document.getElementById("shopping-cart-variant-item-status");this.querySelector("form").addEventListener("submit",this.onSubmit.bind(this));var t=debounce(t=>{this.onChange(t)},ON_CHANGE_DEBOUNCE_TIMER);this.addEventListener("change",t.bind(this))}cartUpdateUnsubscriber=void 0;onSubmit(t){t.preventDefault()}connectedCallback(){this.cartUpdateUnsubscriber=subscribe(PUB_SUB_EVENTS.cartUpdate,t=>{t.source!==this.quickOrderListId&&this.onCartUpdate()}),this.sectionId=this.dataset.id}disconnectedCallback(){this.cartUpdateUnsubscriber&&this.cartUpdateUnsubscriber()}onChange(t){var e=parseInt(t.target.value),i=parseInt(t.target.dataset.cartQuantity),t=t.target.dataset.index,r=document.activeElement.getAttribute("name"),s=e-i;0<i?this.updateQuantity(t,e,r,this.actions.update):this.updateQuantity(t,s,r,this.actions.add)}onCartUpdate(){fetch(window.location.pathname+"?section_id="+this.sectionId).then(t=>t.text()).then(t=>{t=(new DOMParser).parseFromString(t,"text/html").querySelector(this.quickOrderListId);this.innerHTML=t.innerHTML}).catch(t=>{console.error(t)})}getSectionsToRender(){return[{id:this.quickOrderListId,section:document.getElementById(this.quickOrderListId).dataset.id,selector:".js-contents"},{id:"cart-icon-bubble",section:"cart-icon-bubble",selector:".shopify-section"},{id:"quick-order-list-live-region-text",section:"cart-live-region-text",selector:".shopify-section"},{id:"quick-order-list-total",section:document.getElementById(this.quickOrderListId).dataset.id,selector:".quick-order-list__total"},{id:"CartDrawer",selector:"#CartDrawer",section:"cart-drawer"}]}renderSections(i){this.getSectionsToRender().forEach(t=>{var e=document.getElementById(t.id),e=(e&&e.parentElement&&e.parentElement.classList.contains("drawer")&&(0<i.items.length?e.parentElement.classList.remove("is-empty"):e.parentElement.classList.add("is-empty"),setTimeout(()=>{document.querySelector("#CartDrawer-Overlay").addEventListener("click",this.cart.close.bind(this.cart))})),e&&e.querySelector(t.selector)?e.querySelector(t.selector):e);e&&(e.innerHTML=this.getSectionInnerHTML(i.sections[t.section],t.selector))})}updateMultipleQty(t){this.querySelector(".variant-remove-total .loading__spinner").classList.remove("hidden");t=JSON.stringify({updates:t,sections:this.getSectionsToRender().map(t=>t.section),sections_url:window.location.pathname});this.updateMessage(),this.setErrorMessage(),fetch(""+routes.cart_update_url,{...fetchConfig(),body:t}).then(t=>t.text()).then(t=>{t=JSON.parse(t);this.renderSections(t)}).catch(()=>{this.setErrorMessage(window.cartStrings.error)}).finally(()=>{this.querySelector(".variant-remove-total .loading__spinner").classList.add("hidden")})}updateQuantity(n,a,o,d){this.toggleLoading(n,!0);let t=routes.cart_change_url,e=JSON.stringify({quantity:a,id:n,sections:this.getSectionsToRender().map(t=>t.section),sections_url:window.location.pathname}),i;d===this.actions.add&&(i="javascript",t=routes.cart_add_url,e=JSON.stringify({items:[{quantity:parseInt(a),id:parseInt(n)}],sections:this.getSectionsToRender().map(t=>t.section),sections_url:window.location.pathname})),this.updateMessage(),this.setErrorMessage(),fetch(""+t,{...fetchConfig(i),body:e}).then(t=>t.text()).then(e=>{var e=JSON.parse(e),i=document.getElementById("Quantity-"+n);document.querySelectorAll(".variant-item");if(e.description||e.errors){const s=document.querySelector(`[id^="Variant-${n}"] .variant-item__totals.small-hide .loading__spinner`);s.classList.add("loading__spinner--error"),this.resetQuantityInput(n,i),void(e.errors?this.updateLiveRegions(n,e.errors):this.updateLiveRegions(n,e.description))}else{this.classList.toggle("is-empty",0===e.item_count),this.renderSections(e);let t=!1;var r=e.items.find(t=>t.variant_id===parseInt(n)),r=r?r.quantity:void 0;r&&r!==a&&(this.updateError(r,n),t=!0);const s=document.getElementById("Variant-"+n);s&&s.querySelector(`[name="${o}"]`)&&s.querySelector(`[name="${o}"]`).focus(),publish(PUB_SUB_EVENTS.cartUpdate,{source:this.quickOrderListId,cartData:e}),t?this.updateMessage():d===this.actions.add?this.updateMessage(parseInt(a)):d===this.actions.update?this.updateMessage(parseInt(a-i.dataset.cartQuantity)):this.updateMessage(-parseInt(i.dataset.cartQuantity))}}).catch(t=>{this.querySelectorAll(".loading__spinner").forEach(t=>t.classList.add("hidden")),this.resetQuantityInput(n),console.error(t),this.setErrorMessage(window.cartStrings.error)}).finally(()=>{this.toggleLoading(n)})}resetQuantityInput(t,e){e=e??document.getElementById("Quantity-"+t);e.value=e.getAttribute("value")}setErrorMessage(i=null){this.errorMessageTemplate=this.errorMessageTemplate??document.getElementById("QuickOrderListErrorTemplate-"+this.sectionId).cloneNode(!0),document.querySelectorAll(".quick-order-list-error").forEach(t=>{var e;t.innerHTML="",i&&((e=this.errorMessageTemplate.cloneNode(!0)).content.querySelector(".quick-order-list-error-message").innerText=i,t.appendChild(e.content))})}updateMessage(t=null){var e=this.querySelectorAll(".quick-order-list__message-text"),i=this.querySelectorAll(".quick-order-list__message-icon");if(null===t||isNaN(t))e.forEach(t=>t.innerHTML=""),i.forEach(t=>t.classList.add("hidden"));else{var r=t<0;const s=Math.abs(t),n=r?1===s?window.quickOrderListStrings.itemRemoved:window.quickOrderListStrings.itemsRemoved:1===t?window.quickOrderListStrings.itemAdded:window.quickOrderListStrings.itemsAdded;e.forEach(t=>t.innerHTML=n.replace("[quantity]",s)),r||i.forEach(t=>t.classList.remove("hidden"))}}updateError(t,e){let i="";i=void 0===t?window.cartStrings.error:window.cartStrings.quantityError.replace("[quantity]",t),this.updateLiveRegions(e,i)}updateLiveRegions(t,e){var i=document.getElementById("Quick-order-list-item-error-desktop-"+t),t=document.getElementById("Quick-order-list-item-error-mobile-"+t);i&&(i.querySelector(".variant-item__error-text").innerHTML=e,i.closest("tr").classList.remove("hidden")),t&&(t.querySelector(".variant-item__error-text").innerHTML=e),this.variantItemStatusElement.setAttribute("aria-hidden",!0);const r=document.getElementById("quick-order-list-live-region-text");r.setAttribute("aria-hidden",!1),setTimeout(()=>{r.setAttribute("aria-hidden",!0)},1e3)}getSectionInnerHTML(t,e){return(new DOMParser).parseFromString(t,"text/html").querySelector(e).innerHTML}toggleLoading(t,e){var i=document.getElementById(this.quickOrderListId),t=this.querySelectorAll(`#Variant-${t} .loading__spinner`);e?(i.classList.add("quick-order-list__container--disabled"),[...t].forEach(t=>t.classList.remove("hidden")),document.activeElement.blur(),this.variantItemStatusElement.setAttribute("aria-hidden",!1)):(i.classList.remove("quick-order-list__container--disabled"),t.forEach(t=>t.classList.add("hidden")))}}customElements.define("quick-order-list",QuickOrderList);